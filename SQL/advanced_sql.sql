-- lag and lead functions need to be used with Over(partition by order by x)