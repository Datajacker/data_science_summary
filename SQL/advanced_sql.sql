-- lag and lead functions need to be used with Over(partition by y order by x)